{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./index.js"],"names":["document","addEventListener","canvasEl","getElementById","ctx","getContext","W","window","innerWidth","H","innerHeight","width","height","video","snippets","numSnippets","makeSnippets","num","source","pos","rows","Math","sqrt","cols","index","i","j","q1","q2","q3","q4","p1","p2","p3","p4","positions","Object","values","map","snip","widthHeight","drawVideo","clearRect","drawImage","startClick","beingDragged","offsetX","offsetY","startPos","currentSnip","withinBounds","x","y","length","onMouseMove","event","preventDefault","clientX","clientY","e","console","log","slice","removeEventListener","playVideo","requestAnimationFrame"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","document.addEventListener(\"DOMContentLoaded\", () => {\n  const canvasEl = document.getElementById(\"test-canvas\");\n  const ctx = canvasEl.getContext(\"2d\");\n  let W = window.innerWidth;\n  let H = window.innerHeight;\n  canvasEl.width = W;\n  canvasEl.height = H;\n\n  const video = document.getElementById(\"video\");\n\n  const snippets = {};\n  const numSnippets = 4;\n\n  function makeSnippets(num) {\n    let source;\n    let pos;\n    let rows = Math.sqrt(num);\n    let cols = Math.sqrt(num);\n    let index = 1;\n    for (let i = 1; i <= rows; i++) {\n      for (let j = 1; j <= cols; j++) {\n        source = [\n          video.width * (1 - 1 / j),\n          video.height * (1 - 1 / i),\n          video.width / rows,\n          video.height / cols\n        ];\n\n        pos = [source[0], source[1]];\n\n        snippets[index] = { source, pos };\n        index++;\n      }\n    }\n  }\n  makeSnippets(numSnippets);\n\n  const q1 = [0, 0, 320, 180];\n  const q2 = [320, 0, 320, 180];\n  const q3 = [0, 180, 320, 180];\n  const q4 = [320, 180, 320, 180];\n\n  const p1 = [0, 0];\n  const p2 = [320, 0];\n  const p3 = [0, 180];\n  const p4 = [320, 180];\n  const positions = Object.values(snippets).map(snip => snip.pos);\n\n  const widthHeight = [320, 180];\n\n  function drawVideo() {\n    ctx.clearRect(0, 0, W, H);\n\n    for (let i = 1; i <= numSnippets; i++) {\n      ctx.drawImage(\n        video,\n        ...snippets[i].source,\n        ...snippets[i].pos,\n        ...widthHeight\n      );\n    }\n    // ctx.drawImage(video, ...q1, ...p1, ...widthHeight);\n    // ctx.drawImage(video, ...q2, ...p2, ...widthHeight);\n    // ctx.drawImage(video, ...q3, ...p3, ...widthHeight);\n    // ctx.drawImage(video, ...q4, ...p4, ...widthHeight);\n    // ctx.drawImage(video, 0, 0, 640, 360, 0, 0, 320, 240);\n  }\n\n  let startClick;\n  let beingDragged;\n  let offsetX;\n  let offsetY;\n  let startPos;\n  let currentSnip;\n\n  function withinBounds(x, y) {\n    let pos;\n    for (let i = 0; i < positions.length; i++) {\n      pos = positions[i];\n      if (\n        x > pos[0] &&\n        x < pos[0] + widthHeight[0] &&\n        y > pos[1] &&\n        y < pos[1] + widthHeight[1]\n      ) {\n        return i + 1;\n      }\n    }\n    return null;\n  }\n\n  function onMouseMove(event) {\n    event.preventDefault();\n    if (event.clientX < 0 || event.clientY < 0 || beingDragged === null) {\n      return;\n    }\n    offsetX = event.clientX - startClick[0];\n    offsetY = event.clientY - startClick[1];\n    currentSnip = snippets[beingDragged];\n    currentSnip.pos[0] = startPos[0] + offsetX;\n    currentSnip.pos[1] = startPos[1] + offsetY;\n  }\n\n  document.addEventListener(\"mousedown\", e => {\n    startClick = [e.clientX, e.clientY];\n    console.log(\"down!\");\n    beingDragged = withinBounds(...startClick);\n    console.log(snippets);\n    console.log(beingDragged);\n    startPos = snippets[beingDragged].pos.slice(0);\n    // switch (beingDragged) {\n    //   case 0:\n    //     startPos = p1.slice(0);\n    //     break;\n    //   case 1:\n    //     startPos = p2.slice(0);\n    //     break;\n    //   case 2:\n    //     startPos = p3.slice(0);\n    //     break;\n    //   case 3:\n    //     startPos = p4.slice(0);\n    //     break;\n    //   default:\n    //     startPos = null;\n    //     break;\n    // }\n    document.addEventListener(\"mousemove\", onMouseMove);\n  });\n\n  document.addEventListener(\"mouseup\", e => {\n    e.preventDefault();\n    document.removeEventListener(\"mousemove\", onMouseMove);\n    beingDragged = null;\n  });\n\n  function playVideo() {\n    drawVideo();\n    requestAnimationFrame(playVideo);\n  }\n\n  requestAnimationFrame(playVideo);\n});\n"],"sourceRoot":""}