{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./index.js"],"names":["document","addEventListener","canvasEl","getElementById","ctx","getContext","W","window","innerWidth","H","innerHeight","width","height","video","snippets","originalPositions","numSnippets","movementSpeed","makeSnippets","num","source","pos","rows","Math","sqrt","cols","index","i","j","randomPos","x","floor","random","y","positions","Object","values","map","snip","widthHeight","drawVideo","clearRect","incX","maxX","maxY","incY","drawImage","startClick","beingDragged","offsetX","offsetY","startPos","currentSnip","withinBounds","length","onMouseMove","event","preventDefault","clientX","clientY","e","console","log","slice","removeEventListener","scramble","randomPosition","key","hasOwnProperty","reform","stopPropagation","number","playVideo","requestAnimationFrame"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","document.addEventListener(\"DOMContentLoaded\", () => {\n  const canvasEl = document.getElementById(\"test-canvas\");\n  const ctx = canvasEl.getContext(\"2d\");\n  let W = window.innerWidth;\n  let H = window.innerHeight;\n  canvasEl.width = W;\n  canvasEl.height = H;\n\n  const video = document.getElementById(\"video\");\n\n  const snippets = {};\n  const originalPositions = {};\n  let numSnippets = 144;\n  let movementSpeed = 100;\n\n  function makeSnippets(num) {\n    let source;\n    let pos;\n    let rows = Math.sqrt(num);\n    let cols = Math.sqrt(num);\n    let index = 1;\n    for (let i = 1; i <= rows; i++) {\n      for (let j = 1; j <= cols; j++) {\n        source = [\n          video.width * (1 - j / cols),\n          video.height * (1 - i / rows),\n          video.width / rows,\n          video.height / cols\n        ];\n\n        pos = [source[0], source[1]];\n\n        snippets[index] = { source, pos };\n        originalPositions[index] = [pos[0], pos[1]];\n        index++;\n      }\n    }\n  }\n  makeSnippets(numSnippets);\n\n  function randomPos() {\n    let x = Math.floor(Math.random() * (canvasEl.width - 100));\n    let y = Math.floor(Math.random() * (canvasEl.height - 100));\n    return [x, y];\n  }\n\n  const positions = Object.values(snippets).map(snip => snip.pos);\n\n  const widthHeight = [\n    video.width / Math.sqrt(numSnippets),\n    video.height / Math.sqrt(numSnippets)\n  ];\n\n  function drawVideo() {\n    ctx.clearRect(0, 0, W, H);\n\n    for (let i = 1; i <= numSnippets; i++) {\n      if (\n        snippets[i].incX &&\n        ((snippets[i].pos[0] <= snippets[i].maxX && snippets[i].incX > 0) ||\n          (snippets[i].pos[0] >= snippets[i].maxX && snippets[i].incX < 0)) &&\n        ((snippets[i].pos[1] <= snippets[i].maxY && snippets[i].incY > 0) ||\n          (snippets[i].pos[1] >= snippets[i].maxY && snippets[i].incY < 0))\n      ) {\n        snippets[i].pos[0] += snippets[i].incX;\n        snippets[i].pos[1] += snippets[i].incY;\n      }\n      ctx.drawImage(\n        video,\n        ...snippets[i].source,\n        ...snippets[i].pos,\n        ...widthHeight\n      );\n    }\n  }\n\n  let startClick;\n  let beingDragged;\n  let offsetX;\n  let offsetY;\n  let startPos;\n  let currentSnip;\n\n  function withinBounds(x, y) {\n    let pos;\n    for (let i = 0; i < positions.length; i++) {\n      pos = positions[i];\n      if (\n        x > pos[0] &&\n        x < pos[0] + widthHeight[0] &&\n        y > pos[1] &&\n        y < pos[1] + widthHeight[1]\n      ) {\n        return i + 1;\n      }\n    }\n    return null;\n  }\n\n  function onMouseMove(event) {\n    event.preventDefault();\n    if (event.clientX < 0 || event.clientY < 0 || beingDragged === null) {\n      return;\n    }\n    offsetX = event.clientX - startClick[0];\n    offsetY = event.clientY - startClick[1];\n    currentSnip = snippets[beingDragged];\n    currentSnip.pos[0] = startPos[0] + offsetX;\n    currentSnip.pos[1] = startPos[1] + offsetY;\n  }\n\n  document.addEventListener(\"mousedown\", e => {\n    e.preventDefault();\n    startClick = [e.clientX, e.clientY];\n    console.log(\"down!\");\n    beingDragged = withinBounds(...startClick);\n    if (beingDragged === null) {\n      return;\n    }\n    startPos = snippets[beingDragged].pos.slice(0);\n    document.addEventListener(\"mousemove\", onMouseMove);\n  });\n\n  document.addEventListener(\"mouseup\", e => {\n    e.preventDefault();\n    document.removeEventListener(\"mousemove\", onMouseMove);\n    beingDragged = null;\n  });\n\n  const scramble = document.getElementById(\"scramble\");\n\n  scramble.addEventListener(\"click\", () => {\n    let randomPosition;\n    for (var key in snippets) {\n      if (!snippets.hasOwnProperty(key)) continue;\n      randomPosition = randomPos();\n      snippets[key].maxX = randomPosition[0];\n      snippets[key].maxY = randomPosition[1];\n      snippets[key].incX =\n        (snippets[key].maxX - snippets[key].pos[0]) / movementSpeed;\n      snippets[key].incY =\n        (snippets[key].maxY - snippets[key].pos[1]) / movementSpeed;\n    }\n  });\n\n  const reform = document.getElementById(\"reform\");\n\n  reform.addEventListener(\"click\", e => {\n    e.stopPropagation();\n    for (var key in snippets) {\n      if (!snippets.hasOwnProperty(key)) continue;\n      snippets[key].maxX = originalPositions[key][0];\n      snippets[key].maxY = originalPositions[key][1];\n      snippets[key].incX =\n        (snippets[key].maxX - snippets[key].pos[0]) / movementSpeed;\n      snippets[key].incY =\n        (snippets[key].maxY - snippets[key].pos[1]) / movementSpeed;\n    }\n  });\n\n  const number = document.getElementById(\"number\");\n\n  // number.addEventListener(\"change\", e => {\n  //   numSnippets = number.value;\n  //   makeSnippets(numSnippets);\n  // });\n\n  function playVideo() {\n    drawVideo();\n    requestAnimationFrame(playVideo);\n  }\n\n  requestAnimationFrame(playVideo);\n});\n"],"sourceRoot":""}